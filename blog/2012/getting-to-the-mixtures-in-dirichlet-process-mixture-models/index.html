<!DOCTYPE html>
<html>

  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>

  FozzieTheBeat


  | Getting to the Mixtures in Dirichlet Process Mixture Models

</title>
<meta name="description" content="A simple blog tracking my journey back into Open Source.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<link rel="stylesheet" href="https://raw.githubusercontent.com/jwarby/pygments-css/master/github.css" />

<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>">

<link rel="stylesheet" href="/assets/css/main.css">
<link rel="canonical" href="/blog/2012/getting-to-the-mixtures-in-dirichlet-process-mixture-models/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/assets/js/theme.js"></script>
<script src="/assets/js/dark_mode.js"></script>






    
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

    <!-- Nav Bar -->
    <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
    <div class="container">
      
      <a class="navbar-brand title font-weight-lighter" href="https://fozziethebeat.com/">
       FozzieTheBeat
      </a>
      
      <!-- Navbar Toggle -->
      <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar top-bar"></span>
        <span class="icon-bar middle-bar"></span>
        <span class="icon-bar bottom-bar"></span>
      </button>
      <div class="collapse navbar-collapse text-right" id="navbarNav">
        <ul class="navbar-nav ml-auto flex-nowrap">
          <!-- About -->
          <li class="nav-item ">
            <a class="nav-link" href="/">
              about
              
            </a>
          </li>
          
          <!-- Blog -->
          <li class="nav-item active">
            <a class="nav-link" href="/blog/">
              blog
              
            </a>
          </li>
          

          <!-- Other pages -->
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/projects/">
                projects
                
              </a>
          </li>
          
          
          
          
          
          <li class="nav-item ">
              <a class="nav-link" href="/publications/">
                publications
                
              </a>
          </li>
          
          
          
          
            <div class = "toggle-container">
              <a id = "light-toggle">
                  <i class="fas fa-moon"></i>
                  <i class="fas fa-sun"></i>
              </a>
            </div>
          
        </ul>
      </div>
    </div>
  </nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      

<div class="post">

  <header class="post-header">
    <h1 class="post-title">Getting to the Mixtures in Dirichlet Process Mixture Models</h1>
    <p class="post-meta">May 4, 2012</p>
  </header>

  <article class="post-content">
    <p>The <a href="https://en.wikipedia.org/wiki/Dirichlet_process">Dirichlet Process</a> is pretty sweet as <a href="http://blog.echen.me/2012/03/20/infinite-mixture-models-with-nonparametric-bayes-and-the-dirichlet-process/">Edwin Chen</a> and numerous others have
pointed out. When combined with a mixture of Bayesian models, it’s really
effective for finding an accurate number of models needed to represent your
bundle of data, especially useful when you have no idea how many bundles of
related words you may have. Edwin Chen does a really great job of explaining
how the Dirichlet Process works, how to implement it, and how it can break down
the McDonald’s menu, but he leaves out details on how to combine it with
mixture models, which is by far the coolest part.</p>

<p>The short description for how to merge the Dirichlet Process with
<a href="https://en.wikipedia.org/wiki/Mixture_model">Nonparametric Mixture Modeling</a>
(and infer the model) looks like this:</p>

<ol>
  <li>Define probability distributions for your mixture model</li>
  <li>Rewrite your distributions with Bayes rule so that parameters depend on
data and hyper parameters</li>
  <li>Repeat step 2 for hyper parameters as desired (it’s turtles all the way
down, as Kevin Knight said)</li>
  <li>For each data point
    1.  Forget about the current data point
    1.  Compute the likelihood that each mixture made this data point
    1.  Sampling a new label for this data point using these likelihoods
    1.  Jot down this new label
    1.  Remember this data point</li>
  <li>After seeing all the data, re-estimate all your parameters based on the
new assignments</li>
  <li>Repeat steps 4 and 5 ad nausea.</li>
</ol>

<p>In short, this is the Gibbs Sampling approach. If you already know what your distributions look like, and this paltry description made perfect sense, Hurray! Please go bake a cake for everyone that feels a little underwhelmed with this description.</p>

<p>In short, this is the Gibbs Sampling approach. If you already know what your
distributions look like, and this paltry description made perfect sense,
Hurray! Please go bake a cake for everyone that feels a little underwhelmed
with this description.</p>

<p>Now that someone is off baking us cake, let’s dive down into what the
distributions look like. Taking a look at a number of papers describing
variations of the Dirichlet Process Mixture Model, like The <a href="http://citeseerx.ist.psu.edu/viewdoc/summary?doi=10.1.1.45.9111">Infinite Gaussian
Mixture Model</a>
and <a href="https://projecteuclid.org/journals/bayesian-analysis/volume-1/issue-1/Variational-inference-for-Dirichlet-process-mixtures/10.1214/06-BA104.full">Variational Inference for Dirichlet Process Mixture
Models</a>,
they first make things seem pretty straightforward. To start, they generally
throw down this simple equation:</p>

<p>Simple, no? If you want mixtures of Gaussian models, then has a mean and a
variance, we’ll call these and . The next step is then to rewrite this equation
in a couple of ways so that you define the parameters, i.e. in terms of the
data and other parameters. One example: looks like this:</p>

<p>Not too bad after reading through the definition for all the parameters; the
first bundle describes the mean of the mixture and the second bundle describes
the variance of the mixture. You may have noticed that our means for each
mixture come from a Gaussian distribution themselves (I did say it was turtles
all the way down). If you’re using a nice math coding environment, like
<a href="https://github.com/scalala/Scalala">Scalala</a> and
<a href="http://www.scalanlp.org/">Scalanlp</a>, you can easily sample from this
distribution like this</p>

<div class="language-scala highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">val</span> <span class="nv">theta_j</span> <span class="k">=</span> <span class="k">new</span> <span class="nc">Gamma</span><span class="o">((</span><span class="n">y_mean</span><span class="o">*</span><span class="n">n_j</span><span class="o">*</span><span class="n">s_j</span> <span class="o">+</span> <span class="n">lambda</span><span class="o">*</span><span class="n">r</span><span class="o">)/(</span><span class="n">n_j</span><span class="o">*</span><span class="n">s_j</span><span class="o">+</span><span class="n">r</span><span class="o">),</span> <span class="mf">1d</span><span class="o">/(</span><span class="n">n_j</span><span class="o">*</span><span class="n">s_j</span> <span class="o">+</span><span class="n">r</span><span class="o">)).</span><span class="py">sample</span>
</code></pre></div></div>

<p>This goes on for most of the parameters for the model until you get to one of
the core tear inducing rewrites. This lovely gem describes the probably
distribution function for one of the hyper parameters in the Infinite Gaussian
Mixture Model:</p>

<p>This is not easy to sample from especially if you’re new to sophisticated
sampling methods. And sadly, just about every academic publication describing
these kinds of models gets to a point where they assume you know what they’re
talking about and can throw down Monte Carlo Markov Chain sampling procedures
like they’re rice at a wedding.</p>

<p>So what’s a lowly non-statistician data modeller to do? Start with a well
written description of a similar, but significantly simpler model. In this
case, <a href="http://users.umiacs.umd.edu/~resnik/pubs/gibbs.pdf">Gibbs Sampling for the
Uninitiated</a>, which
describes how to apply Gibbs to the Naive Bayes model. I’ll summarize this
awesome paper in the next part of this series and then tweak it a little to
make a <a href="https://en.wikipedia.org/wiki/Mixture_model#Gaussian_mixture_model">Finite Gaussian Mixture
Model</a>.
After that’s said and done, I’ll show how to extend the finite version into the
Dirichlet Process Mixture Model (with some simplifications).</p>

  </article>

  

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
      <img alt="Creative Commons License"
           style="border-width:0"
           src="https://i.creativecommons.org/l/by/4.0/88x31.png" />
    </a>
    This
    work is licensed under a
    <a rel="license" href="http://creativecommons.org/licenses/by/4.0/">
      Creative Commons Attribution 4.0 International License
    </a>.

    <br />

    Powered by <a href="http://jekyllrb.com/" target="_blank">Jekyll</a> with the <a href="https://github.com/alshedivat/al-folio">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank">GitHub Pages</a>.

  </div>
</footer>



  </body>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/assets/js/common.js"></script>


</html>
